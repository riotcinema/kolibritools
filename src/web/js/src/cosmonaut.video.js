/**
 * cosmonautexperience.com
 *
 * Website for The Cosmonaut movie.
 *
 * NOTE OF LICENSE
 * Licensed under GNU General Public License version 3.0
 *
 * Copyright (c) 2013 Tecnil贸gica Soluciones Avanzadas.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the GNU Public License v3.0
 * which accompanies this distribution, and is available at
 * http://www.gnu.org/licenses/gpl.html
 *
 * Contributors:
 * Tecnil贸gica Soluciones Avanzadas - initial API and implementation
 *
 * @package   cosmonautexperience
 * @author    Tecnil贸gica soluciones avanzadas
 * @copyright Copyright (c) 2003 - 2013, Tecnil贸gica soluciones avanzadas, S.A. (http://tecnilogica.com/)
 * @license   http://www.gnu.org/licenses/gpl-3.0.html
 * @link      http://cosmonautexperience.com
 * 
 * 
 * cosmonaut.video.js
 */
cosmonaut.video=new Array();cosmonaut.video.addFacebookButton=function(v){var l=$(document.createElement('a')).addClass("btn").addClass("tiny").addClass("white").addClass("facebook").attr("id","link_to_facebook").attr("href","#").html("{{@dict_com_facebook}}").appendTo("#div_social");$(l).bind('click','a',function(e){e.preventDefault();switch (v.vid_category){case "_TRANSMEDIA_":var fb_text="{{html_entity_decode(@dict_twitter_text_experience, ENT_NOQUOTES, @ENCODING)}}"+v.vid_title;break;case "_DIARY_":var fb_text = "{{html_entity_decode(@dict_twitter_text_videodiary, ENT_NOQUOTES, @ENCODING)}}";break;case "_EASTERN_EGG_":var fb_text="{{html_entity_decode(@dict_twitter_text_eastern, ENT_NOQUOTES, @ENCODING)}};";break;}<check if="{{strtolower(@LANGUAGE)=='en'}}"><true>var sy=v.vid_synopsis_long_en;</true><false>var sy=v.vid_synopsis_long_es;</false></check>var o={method:"feed",name:fb_text,redirect_uri:"http://{{$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI']}}",link:"http://{{$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI']}}",picture:"http://farm3.staticflickr.com/2469/buddyicons/1212051@N20.jpg?1257978349",caption:v.vid_title,description:sy,};function cb(r){}FB.ui(o,cb);});};cosmonaut.video.addTweetButton=function(video){switch (video.vid_category){case "_TRANSMEDIA_":var tt="{{html_entity_decode(@dict_twitter_text_experience, ENT_NOQUOTES, @ENCODING)}}"+video.vid_title;break;case "_DIARY_":var tt="{{html_entity_decode(@dict_twitter_text_videodiary,ENT_NOQUOTES,@ENCODING)}}";break;case "_EASTERN_EGG_":var tt="{{html_entity_decode(@dict_twitter_text_eastern,ENT_NOQUOTES,@ENCODING)}}";break;case "_HUMMINGBIRD_":var tt="{{html_entity_decode(@dict_twitter_text_eastern,ENT_NOQUOTES,@ENCODING)}}";break;}var tu='http://twitter.com/share?url='+encodeURI('{{@short_url}}')+'&via={{@lang_twitter_account}}&text='+tt+'&hashtags={{@dict_twitter_hashtag}}';var link=$(document.createElement('a')).addClass("btn").addClass("tiny").addClass("white").addClass("twitter").attr("id","link_to_twitter").attr("href",tu).attr("target","_blank").html("{{@dict_com_twitter}}").appendTo("#div_social");var d=$(document.createElement('div')).addClass("clearfix").appendTo("#div_social");};cosmonaut.video.closeVideoDialog=function(){cosmonaut.video.resetVideoDialog();$("#video-detail").dialog("close");cosmonaut.video.resetVideoVimeo();};cosmonaut.video.commentVideo=function(vid_id,comment){$.ajax({url:"{{@BASE_URL}}/video/comment/",cache:false,type:"POST",dataType:"json",data:{vid_id:vid_id,com_comment:comment},beforeSend:function(){},complete:function(json_complete){},success:function(json_success){cosmonaut.video.resetVideoDialog();cosmonaut.video.fillVideoDialog($("#vid_slug").val());if (json_success.status = "ok") {$("#input_comment").attr("placeholder",json_success.msg);} else {$("#input_comment").attr("placeholder",json_success.msg);}}});};cosmonaut.video.fillVideoDialog=function(sl){$.ajax({url:"{{@BASE_URL}}/video/detail/",cache:false,type:"POST",dataType:"json",data:{vid_slug:sl},beforeSend:function(){},complete:function(json_complete){},success:function(json_success){if (json_success.status = "ok"){cosmonaut.video.video2lightbox(json_success.result);}}});};cosmonaut.video.markAsWatched=function(e){$.ajax({url:"{{@BASE_URL}}/video/watched/",cache:false,type:"POST",dataType:"json",data:{vid_id:e},beforeSend:function(){},complete:function(e){},success:function(e){}})};cosmonaut.video.openVideoDialog=function(e){$(".ui-dialog").css("z-index",10);$("#video-detail").dialog("moveToTop");$("#video-detail").dialog({position:"top"});$("#video-detail").dialog("open");cosmonaut.video.fillVideoDialog(e)};cosmonaut.video.playVideo=function(){cosmonaut.pauseVimeo("iframe-video-detail");$("#vid-detail-cover").fadeOut("slow");$("#span_play").fadeOut("slow");$("#iframe-video-detail").css("z-index",10);$("#iframe-video-detail").css("display","block");cosmonaut.playVimeo("iframe-video-detail")};cosmonaut.video.resetVideoDialog=function(){$(".questions").remove();$("#vid-detail-cover").attr("src","");$(".ui-dialog").css("z-index",10);$("#video-detail").dialog("moveToTop");$("#video-detail").dialog({position:"top"})};cosmonaut.video.resetVideoVimeo=function(){$("#vid-detail-cover").fadeIn("slow");$("#span_play").fadeIn("slow");$("#iframe-video-detail").css("display","none");cosmonaut.pauseVimeo("iframe-video-detail")};cosmonaut.login.validateCommentForm=function(){$.validity.setup({scrollTo:false});$.validity.start();$("#input_comment").require("{{ @dict_vid_comment_error_required }}");var e=$.validity.end();return e.valid};cosmonaut.video.video2lightbox=function(video){$("#vid-detail-cover").fadeIn("slow");$("#span_play").fadeIn("slow");$("#iframe-video-detail").attr("src", null);var aut={{SessionManager::is_logged()}};if(video.vid_protected==1 && aut!=1){$(".transparency").show();$(".notlogged").show();$("#span_play").hide();}else{$(".transparency").hide();$(".notlogged").hide();$("#span_play").show();}$("#vid_id").val(video.vid_id);$("#vid_slug").val(video.vid_slug);$("#vid-detail-title").html(video.vid_title);$("#vid-detail-cover").attr("alt", video.vid_title);$("#vid-detail-cover").attr("src", "{{@_PATH}}/images/covers/"+video.vid_cover);$("#vid-detail-synopsis").html(video.vid_synopsis_long_{{strtolower(@LANGUAGE)}});var minutes=video.vid_duration!=0 ? Math.floor(video.vid_duration / 60) : 0;var seconds=video.vid_duration!=0 ? video.vid_duration - minutes * 60 : 0;$("#vid-detail-duration").html(" "+minutes.toString()+":"+seconds.toString());<check if="{{strtolower(@LANGUAGE)=='es'}}"><true>var video_id=video.vid_url_es;</true><false>var video_id=video.vid_url_en;</false></check>var domain="http://player.vimeo.com/video/";var params="?api=1&title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff&loop=0;player_id=iframe-video-detail";var url=domain+video_id+params;$("#iframe-video-detail").attr("src",url);$("#iframe-video-detail").attr("data-vid-id",video.vid_id);$("#vid_url").val(url);$("#div_social").empty();cosmonaut.video.addFacebookButton(video);cosmonaut.video.addTweetButton(video);var questions=$(document.createElement('section')).addClass("questions").appendTo($("#video_detail_subwrapper"));var title=$(document.createElement('h3')).addClass("title").html("{{@dict_vid_questions_about}}").appendTo($(questions));var comments=$(document.createElement('span')).addClass("count").appendTo($(questions));var start_sep=$(document.createElement('div')).addClass("separator").appendTo($(questions));var num_comments=0;$.each(video.vid_comments,function(key,comment){num_comments++;var question=$(document.createElement('div')).addClass("question").appendTo($(questions));var q_user=$(document.createElement('div')).addClass("user").appendTo($(question));var q_tip=$(document.createElement('div')).addClass("tooltip").appendTo($(q_user));if(comment.firstname!=undefined){var q_username=$(document.createElement('span')).html(comment.firstname+' '+comment.lastname).appendTo(q_tip);var q_h_username = $(document.createElement('span')).html(comment.firstname+' '+comment.lastname).appendTo(q_user);}else{var q_anon = $(document.createElement('span')).html("{{@dict_vid_anonimous}}").appendTo(q_user);}var q_comment = $(document.createElement('p')).html(comment.com_comment).appendTo($(question));if(undefined!=comment.com_response){var answer=$(document.createElement('div')).addClass("answer").appendTo($(question));var a_user=$(document.createElement('div')).addClass("user").appendTo($(answer));var a_tip=$(document.createElement('div')).addClass("tooltip").appendTo($(a_user));var a_username=$(document.createElement('span')).html(comment.com_response.usu_nick).appendTo(a_tip);var a_h_username=$(document.createElement('span')).html(comment.com_response.usu_nick).appendTo(a_user);var a_comment=$(document.createElement('p')).html(comment.com_response.res_comment).appendTo($(answer));}var end_sep = $(document.createElement('div')).addClass("separator").appendTo($(questions));});comments.html(num_comments);<check if="{{SessionManager::is_logged()}}"><true>var leave=$(document.createElement('div')).addClass("leave-a-comment").appendTo($(questions));var user=$(document.createElement('div')).addClass("user").appendTo($(leave));var tip=$(document.createElement('div')).addClass("user").appendTo($(user));var link=$(document.createElement('a')).attr("href","#").addClass("blue").html("{{@dict_vid_comment}}").appendTo($(leave));$(link).bind('click','a',function(event){event.preventDefault();var valid=cosmonaut.login.validateCommentForm();if(valid){cosmonaut.video.commentVideo(video.vid_id,$(input).val());} else {$(".validity-tooltip").each( function(index,item){$(item).offset({ top: $(item).position().top-40, left: $(item).position().left-30});});}});var input=$(document.createElement('textarea')).attr("type","text").attr("placeholder","{{@dict_vid_ask}}").attr("id","input_comment").appendTo($(leave));$(input).bind('focusin', function(event){$(input).animate( {"height":"150px"},"fast");});$(input).bind('focusout', function(event){$(input).animate({"height":"30px"},"fast");});</true><false>var sign=$(document.createElement('div')).addClass("sign-in").appendTo($(questions));var ein = $(document.createElement('span')).html("?").appendTo($(sign));var p_link = $(document.createElement('p')).appendTo($(sign));var link = $(document.createElement('a')).attr("href","#").addClass("sign_in_link").addClass("blue").html("{{@dict_vid_sign_in}}").appendTo($(p_link));$(p_link).bind('click','a',function(event){event.preventDefault();cosmonaut.video.closeVideoDialog();cosmonaut.login.showLogin();});$(p_link).html($(p_link).html()+" {{@dict_vid_to_comment}}");</false></check>};$(".sign_in_link").click(function(e){e.preventDefault();cosmonaut.video.closeVideoDialog();cosmonaut.login.showLogin();});